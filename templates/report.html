<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inspection Report</title>
   
    <style>/* General Styles */
      body {
          font-family: Arial, sans-serif;
          margin: 0;
          padding: 0;
          color: #333;
          line-height: 1.6;
      }
      
      /* Title Page - Portrait Orientation */
      @page:first {
          size: A4 portrait; /* Portrait orientation for the first page */
          margin-top: 10mm; /* Remove top margin */
          margin-left: 20mm;
          margin-right: 20mm;
          margin-bottom: 20mm; /* 20mm margin on all other sides */
      }
      
      /* Other Pages - Landscape Orientation */
      @page {
          size: A4 landscape; /* Landscape orientation for subsequent pages */
          margin: 20mm;
      }
      
      @media print {
          
      
          .page {
              position: relative; /* Ensure content doesn't overlap the footer */
              min-height: calc(100vh - 20mm); /* Account for @page margin */
              margin-bottom: 20mm; /* Leave room for the footer */
              margin: 0; /* Eliminate gaps at the top of the page */
              padding-top: 0; /* Ensure no extra space above the header */
              box-sizing: border-box;
          }
      
          .page-break {
              page-break-before: always;
          }
      
          .title-page {
              page-break-after: always;
          }
      }
    
    /* Allow resizing for long blocks of text */
    .inspection-details .text p {
        display: block; /* Ensure paragraph behaves as a block */
        text-align: justify; /* Optional: Align text neatly */
        overflow-wrap: break-word; /* Break long words if necessary */
        font-size: clamp(10px, 1.2vw, 16px); /* Adjust font size for container */
    }
      
      
      
    .header {
      transform: translateY(-40px);
      display: flex;
      justify-content: space-between; /* Space out items evenly */
      align-items: center; /* Vertically center all content */
      
      border-bottom: 1.75px solid #004d99;
      
      height: auto; /* Allow height to adjust to content */
      box-sizing: border-box;
  }
  
  .header img {
    max-height: 80px; /* Restrict logo height */
    max-width: 150px;
    display: block;
    flex-shrink: 0; /* Prevent logo from shrinking */
}

  .header .title {
    font-size: 24px;
    font-weight: bold;
    color: #004d99;
    flex-grow: 1; /* Allow title to take available space */
    text-align: center; /* Center the title */
    margin: 0 20px; /* Add spacing between the logo and title */
    overflow: hidden; /* Hide overflowed text */
    text-overflow: ellipsis; /* Add ellipsis for long titles */
    white-space: nowrap; /* Prevent title wrapping */
}
      

.customer-info h2 {
  margin: 0;
  font-size: 18px;
  font-weight: bold;
  color: #004d99;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.customer-info p {
  margin: 5px 0;
  font-size: 11px; /* Reduced font size for better fit */
  color: #777;
  word-wrap: break-word; /* Ensures long text wraps */
  white-space: normal; /* Allows full text display */
}

.customer-info {
  max-height: 70px; /* Limit height to avoid taking over the header */
  overflow-y: auto; /* Allow scrolling if content exceeds height */
}
      
.header .customer-info {
  text-align: right;
  flex-shrink: 0; /* Prevent customer info from shrinking */
  max-width: 30%; /* Limit width to avoid taking too much space */
  overflow: hidden; /* Hide overflowed content */
  text-overflow: ellipsis; /* Add ellipsis for overflowing text */
  white-space: nowrap; /* Prevent wrapping */
  font-size: 12px;
  color: #333;
}
      
.customer-info p.description {
  font-size: 11px; /* Slightly larger font size for the description */
  line-height: 1.1; /* Better readability for long text */
}     
      
      
.header {
  height: auto; /* Allows the header to grow with content */
  overflow: hidden;
  white-space: normal;
}  
      
      
      
      
      .page {
        page-break-inside: avoid; /* Ensure the entire page stays together */
    }
      
      
      
      .title-header-image img {
          max-width: 80%; /* Restrict width to 80% of the container */
          max-height: 400px; /* Limit the height to a reasonable size */
          margin: 20px auto; /* Center the image with some margin */
          display: block; /* Ensure proper alignment */
          object-fit: contain; /* Maintain aspect ratio */
      }
      
      
      .title-header {
          text-align: center;
          position: relative;
          
          padding: 0; /* Remove padding from the header */
          margin: 0; /* Remove any default margin */
        }
      
      
      
      .title-logo {
          margin: 0; /* Remove margin from the logo container */
          padding: 0; /* Remove padding from the logo container */
      }
      
      .title-logo img {
          
          max-height: 100px;
          display: block;
          margin: 0 auto; /* Center the image */
      }
        
        .company-contact-info {
          position: absolute;
          top: 15mm;
          right: 0mm;
          font-size: 12px;
          line-height: 1.4;
          text-align: right;
          color: #666;
          white-space: normal; /* Allows wrapping */
          word-wrap: break-word; /* Ensures long words break if necessary */
        }
        
        .contact-email,
        .contact-address {
          margin: 0;
        }
        
        .title-divider {
          border: 1px solid #ddd;
          margin: 20px 0;
        }
        
        .title-summary {
          text-align: center;
          margin-top: 20px;
          font-size: 20px;
        }
        
        .main-heading {
          font-size: 28px;
          margin: 10px 0;
        }
        
        .summary {
          font-size:14px;
        }
      
      
      
      
      /* Revisions Table Styling */
      .revisions-table {
          margin-top: 20px;
          width: 100%;
          text-align: left;
      }
      
      .revisions-table .table {
          transform:translateY(5px);
          width: 100%;
          border-collapse: collapse;
          margin-top: 15px;
          font-size: 14px;
      }
      
      .revisions-table .table th,
      .revisions-table .table td {
          padding: 2.5px 8px; /* Reduced padding to bring rows closer together */
          border: 1px solid #ddd;
      }
      
      .revisions-table .table th {
          background-color: #f2f2f2;
          font-weight: bold;
      }
      
      .revisions-table .table tr:nth-child(even) {
          background-color: #f9f9f9;
      }
      
      .revisions-table .table tr:hover {
          background-color: #f1f1f1;
      }
      
      
      
      
      
      
      
      
      
      td.ellipsis {
        overflow: hidden;              /* Hide content that overflows */
        text-overflow: ellipsis;       /* Apply ellipsis when content overflows */
        display: -webkit-box;          /* Required for multi-line truncation */
        -webkit-line-clamp: 2;         /* Limit to 2 lines (1 wrap + 1 line) */
        -webkit-box-orient: vertical;  /* Set box orientation */
        white-space: normal;           /* Allow wrapping of text */
        max-width: 1300px;              /* Set a max width for the cell */
      }
      
      /* Table */
      .table {
        transform: translateY(-40px);
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        font-size: 14px;
        text-align: left;
      }
      
      .table th,
      .table td {
        padding: 8px 12px;
      }
      
      .table th {
        border-bottom: 2px solid #ddd; /* Underline header row */
        background-color: #f9f9f9;     /* Subtle background for headers */
        color: #333;                   /* Darker text color for contrast */
        font-weight: bold;
      }
      
      .table tr:nth-child(even) {
        background-color: #f9f9f9;     /* Light gray striping for even rows */
      }
      
      .table td {
        border-bottom: 1px solid #ddd; /* Thin horizontal lines between rows */
      }
      
      /* Remove bottom border from the last row */
      .table tr:last-child td {
        border-bottom: none;
      }
      
      
      /* Inspection Details */
      .inspection-details {
        transform: translateY(-40px);
          display: flex;
          justify-content: space-between;
          margin: 20px 0;
          gap: 20px; /* Add space between the text and image */
          flex-wrap: wrap; /* Allow the content to wrap on smaller screens */
          max-height: 100%; /* Prevent the content from overflowing */
          position: relative; /* Allow proper positioning of image */
      }
      
      .inspection-details .text {
          width: 100%; /* Default to full width for smaller screens */
          max-width: 70%; /* Limit width on larger screens */
          white-space: normal; /* Allow text to wrap */
      }
      
      
      
      
      /* Fix the image size and position it on the far right */
      .inspection-details img {
          max-width: 300px; /* Set a fixed width for the image */
          height: 300px; /* Maintain the aspect ratio */
          position: absolute; /* Position it absolutely */
          right: 20mm; /* Align it to the right with some margin */
          top: mm; /* Adjust top position if needed */
          object-fit: contain; /* Ensure image scaling is correct */
      }
      
      /* Inspection Details */
      .inspection-details {
        font-size: 13.5px;
          display: flex;
          justify-content: space-between;
          margin: 20px 0;
          gap: 20px; /* Add space between the text and image */
          flex-wrap: wrap; /* Allow the content to wrap on smaller screens */
          max-height: 100%; /* Prevent the content from overflowing */
          position: relative; /* Allow proper positioning of image */
          page-break-inside: avoid; /* Avoid breaking the section */
          overflow: hidden; /* Ensure no overflowing content */
      }
      
      .inspection-details .text {
          width: 100%; /* Default to full width for smaller screens */
          max-width: 70%; /* Limit width on larger screens */
          white-space: normal; /* Allow text to wrap */
      }
      
      /* Figure Styling */
      .inspection-details figure {
          position: absolute; /* Keep figure positioned to the right */
          right: -10mm; /* Align figure to the far right */
          top: 0mm; /* Adjust top position as needed */
          width: 320px; /* Fixed width for the figure */
          max-width: 300px; /* Restrict figure width */
          max-height: 200px;
          text-align: left; /* Center-align content within the figure */
          margin: 0 auto;
      }
      
      /* Caption Styling (Above the Image) */
      /* Caption Styling (Underneath the Image and Moved Left) */
      .inspection-details figure figcaption {
          margin-bottom: 5mm; /* Space between image and caption */
          font-size: 14px; /* Small font size for the caption */
          color: #666; /* Subtle text color */
          text-align: left; /* Center-align the caption */
          display: block; /* Ensure caption behaves like a block element */
          position: relative; /* Enable offset adjustments */
          left: -20mm; /* Move caption 10mm to the left */
      }
      
      
      /* Image Styling */
      .inspection-details figure img {
          width: 100%; /* Match the figure's width */
          height: auto; /* Maintain aspect ratio */
          object-fit: contain; /* Ensure proper scaling */
          display: block; /* Ensure the image behaves like a block element */
          margin: 0 auto; /* Center the image */
      }
      
      
      
      /* Responsive Design for Smaller Screens */
      @media (max-width: 768px) {
          .inspection-details .text {
              width: 100%; /* Take up full width */
          }
      
          .inspection-details figure {
              position: static; /* Reset positioning */
              margin: 20px auto; /* Center align the figure */
              max-width: 100%; /* Allow figure to scale */
          }
      
          .inspection-details figure img {
              max-width: 100%; /* Allow image to scale */
          }
      
          .inspection-details figure figcaption {
              text-align: center; /* Ensure caption remains centered */
          }
          .customer-info .description {
            white-space: nowrap; /* Prevents text wrapping */
            overflow: hidden; /* Hides overflow content */
            
            display: block; /* Ensures block behavior for consistent layout */
            max-width: 100%; /* Restricts the width to the container */
            
          }
      }

    




   
    
    </style>
  </head>
  <body>
    <div class="content">
        <!-- Title Page -->
        <div class="page">
          <div class="title-page">
            <div class="title-header">
              <div class="title-logo">
                <img src="{{ logo }}" alt="Customer Logo" />
              </div>
              <div class="company-contact-info">
                <p class="contact-email">0404 280 928</p>
                <p class="contact-address">unit 8B 13 Hartley Drive</p>
                <p class="contact-address">Thornton NSW</p>
              </div>
            </div>
        
            <!-- Divider -->
            <hr class="title-divider" />
            
            <div class="title-summary">
              <h1 class="main-heading">{{inspection_header.title}}</h1>
              <div class="title-header-image">
                <img src="{{ inspection_header.image_url }}" alt="Inspection Image" />
              </div>
              <div >
                <p class="summary">{{ inspection_header.summary }}</p>
              </div>
            </div>
        


            <div class="revisions-table">
              <h3>Revisions</h3>
              <table class="table">
                  <thead>
                      <tr>
                          <th>Date</th>
                          <th>Status</th>
                          <th>Detail</th>
                          <th>Issued By</th>
                      </tr>
                  </thead>
                  <tbody>
                    {% for revision in revisions %}
                    <tr>
                        <td>{{ revision.date }}</td>
                        <td>{{ revision.status }}</td>
                        <td>{{ revision.detail }}</td>
                        <td>{{ revision.issued_by }}</td>
                    </tr>
                    {% endfor %}
                      
                  </tbody>
              </table>
          </div>



        </div>
        
          <div class="footer" style="
          position: fixed; 
          bottom: -10mm; 
          left: 0; 
          right: 0; 
          text-align: center; 
          font-size: 12px; 
          color: #666; 
          width: 100%; 
          background-color: transparent; 
          border-top: 2px solid #004d99; /* Divider using border */
          padding: 10px 0 5px 0; /* Extra top padding so content sits below the divider */
          display: flex; 
          justify-content: space-between; 
          align-items: center;
      ">
        <span style="transform: translateX(-20px);">Report by HV Engineers Pty Ltd</span>
        <span style="transform: translateX(20px);">{{inspection_header.date}}</span>
      </div>
      
    



        
        <div class="page-break"></div>

      <!-- Inspection Table Page -->
      <div class="page">
        <div class="header">
          <img src="{{ logo }}" alt="Customer Logo" style="max-height: 800px; width: auto;" />

          <h1>Summary of Finding</h1>
          <div class="customer-info">
            <h2>{{ customer.name }}</h2>
            <p class="description">{{ inspection_header.description }}</p>
           
          </div>
        </div>
        <div class="inspection-table">
         
          <table class="table">
            <thead>
              <tr>
                <th>Area</th>
                <th>Unit</th>
                <th>Item</th>
                <th>Action Required</th>
                <th>Probability</th>
                <th>consequence</th>
                <th>Time Ranking</th>
              </tr>
            </thead>
            <tbody>
              {% for row in rows %}
              <tr>
                <td>{{ row.area }}</td>
                <td>{{ row.unit }}</td>
                <td>{{ row.item }}</td>
                <td>{{ 'Yes' if row.action_required else 'No' }}</td>
                <td>{{ row.probability }}</td>
                <td >{{ row.consequence }}</td>
                <td >{{ row.time_ranking }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        
      </div>
      <div class="page-break"></div>

      <!-- Detailed Inspection Pages -->
      {% for row in rows %}
      <div class="page">
        <div class="header">
          <img src="{{ logo }}" alt="Customer Logo" />
          <h1 class="inspection-detail">Inspection Report - Detail Sheet</h1>
          <div class="customer-info">
            <h2>{{ customer.name }}</h2>
            <p class="description">{{ inspection_header.description }}</p>
            
          </div>
        </div>
        <div class="inspection-details">
          <div class="text">
              <h3>Inspection Details for: {{ row.item }}</h3>
              <p><strong>Area:</strong> {{ row.area }}</p>
              <p><strong>Unit:</strong> {{ row.unit }}</p>
              <p><strong>Item:</strong> {{ row.item }}</p>
              <p><strong>Observations:</strong> {{ row.observations }}</p>
              <p><strong>Recommendations:</strong> {{ row.recommendations }}</p>
              <p><strong>Action Required:</strong> {{ 'Yes' if row.action_required else 'No' }}</p>
              <p><strong>Probability:</strong> {{ row.probability }}</p>
              <p><strong>Time Ranking:</strong> {{ row.time_ranking }}</p>
              <p><strong>Consequence:</strong> {{ row.consequence }}</p>
              <p><strong>Risk Rating:</strong> {{ row.risk_rating }}</p>

          </div>
          <figure>
              {% if row.image_url%}
              <figcaption>Caption: {{ row.picture_caption }}</figcaption>
              <img src="{{ row.image_url }}" alt="Inspection Image" />
              {% endif %}
          </figure>
      </div>

      
  
      </div>
      <div class="page-break"></div>
      {% endfor %}
    </div>
  </body>
</html>